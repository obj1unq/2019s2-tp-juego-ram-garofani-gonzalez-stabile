import wollok.game.*
import niveles.*
import personajes.*

describe "RaM tests (muy describe)"{

test "multiverso 0,0,1 es 0,0"{
	assert.throwsException({multiverso.at(0,0,1)})
}
test "multiverso 0,0,1 es 0,0 con 1 en vista"{
	multiverso.enVista(1)
	assert.equals(game.at(0,0), multiverso.at(0,0,1))
}
test "multiverso 3,7,2 es 3,7 con 2 en vista"{
	multiverso.enVista(2)
	assert.equals(game.at(3,7), multiverso.at(3,7,2))
}
test "multiverso 3,7,3 es 8,12 con 2 en vista"{
	multiverso.enVista(2)
	assert.equals(game.at(8,12), multiverso.at(3,7,3))
}
test "multiverso 3,7,4 es -7,-3 con 6 en vista"{
	multiverso.enVista(6)
	assert.equals(game.at(-7,-3), multiverso.at(3,7,4))
}
test "rick esta en el universo visible"{
	multiverso.enVista(1)
	rick.position(game.at(7,2), multiverso.enVista())
	assert.equals(game.at(7,2), rick.position())
}
test "rick esta en un universo paralelo a 'izquierda' :D"{
	game.width(10)
	game.height(10)
	multiverso.enVista(2)
	assert.equals(game.at(-3, -8), multiverso.at(game.at(7, 2), 1))
	rick.position(game.at(7,2), 1)
	assert.equals(game.at(-3, -8), rick.position())
}
test "rick esta en un universo paralelo a la 'derecha' ;P"{
	game.width(25)
	game.height(25)
	multiverso.enVista(1)
	rick.position(game.at(7,2), 1)
	assert.equals(game.at(32, 27), rick.position())
}
test "Se crea un portal y hay dos portales en el universo"{
	multiverso.enVista(1)
	gun.trigger(3)
	assert.equals(2, game.allVisuals().size())
}
test "Se crea un portal y rick pasa por el apareciondo en el otro universo"{
	const nroUniversoOrigen = 1
	const nroUniversoDestino = 17
	const position = game.at(3, 7)
	game.clear()
	multiverso.enVista(nroUniversoOrigen)
	multiverso.add(rick)
	multiverso.add(gun)
	gun.position(multiverso.at(position, nroUniversoOrigen))
	rick.position(multiverso.at(position, nroUniversoOrigen))
	rick.grab()
	rick.trigger(nroUniversoDestino)
	assert.equals(multiverso.at(position, nroUniversoOrigen),  rick.position())
	assert.equals(2, game.allVisuals().filter{obj => obj.isPortal()}.size() )
	rick.travel()
	assert.notEquals(multiverso.at(position, nroUniversoDestino), rick.position())
	assert.equals(rick.position(), gun.position())
}
test "¡sep, vale hacer tests también!" {

	assert.that(true)
}
}
